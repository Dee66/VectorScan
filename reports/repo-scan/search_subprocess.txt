.hypothesis/constants/b38550021384ac69:4:[b'\n', 100, ',', ', ', '-', '--allow-network', '--compare', '--diff', '--email', '--endpoint', '--explain', '--gha', '--iam-drift-penalty', '--json', '--lead-capture', '--no-color', '--policies', '--policy', '--policy-manifest', '--resource', '--terraform-bin', '--terraform-tests', '.', '0', '1', '20', ':', '?', 'ALERT', 'Available options: ', 'ERROR', 'Emit JSON result', 'FAIL', 'NEW_PLAN', 'OK', 'OLD_PLAN', 'P-FIN-001', 'P-SEC-001', 'PASS', 'PATH', 'POLICY_ID', 'PRESET', 'Path to tfplan.json', 'ROOT_DIR', 'SKIP', 'TAGGABLE_TYPES', 'TerraformManager', 'TerraformResolution', 'VSCAN_LEAD_ENDPOINT', '__init__.py', '__main__', '_safe_chdir_flag', '_select_strategy', 'address', 'all', 'allow_network', 'append', 'as_json', 'baseline', 'binary', 'buffer', 'checks', 'compare', 'compliance_score', 'count', 'counts', 'email', 'encryption', 'environment', 'error', 'exact', 'explanation', 'factors', 'file', 'finops', 'free', 'generated_at', 'gha', 'iam_drift', 'iam_drift_report', 'id', 'input', 'issues', 'iter_resources', 'legacy', 'load_json', 'low', 'match', 'match_type', 'message', 'metadata', 'metrics', 'mode', 'module', 'module_path', 'name', 'parser_mode', 'path', 'plan', 'plan_diff', 'plan_evolution', 'plan_metadata', 'plan_risk_factors', 'plan_risk_profile', 'platform', 'policies', 'policy', 'policy_errors', 'policy_id', 'policy_ids', 'policy_manifest', 'policy_pack_hash', 'policy_source_url', 'policy_version', 'preview_generated', 'preview_manifest', 'preview_policies', 'profile', 'reason', 'remediation_ledger', 'replace', 'request', 'resource', 'resource_changes', 'resource_count', 'resource_filter', 'resources', 'result', 'returncode', 'risky_change_count', 'risky_changes', 'root', 'scan_duration_ms', 'scan_version', 'schema_version', 'sec', 'security', 'security_grade', 'signature', 'smell_report', 'source', 'src', 'status', 'stderr', 'stdout', 'store_true', 'strategy', 'streaming', 'strict', 'strict_mode_enabled', 'subprocess', 'suffix', 'summary', 'surrogatepass', 'suspicious_defaults', 'tags', 'tempfile', 'terraform_tests', 'timestamp', 'type', 'unknown', 'utf-16', 'utf-8', 'vectorscan', 'vectorscan-cli', 'vectorscan_version', 'verified', 'version', 'violations', 'violations_struct']
docs/checklist.md:144:    - [x] Add test ensuring all subprocess calls are sanitized and cannot escape working directory
docs/checklist.md:145:       - `tests/unit/test_subprocess_sanitization.py::test_modern_strategy_commands_include_safe_chdir` confirms every Terraform subprocess invocation receives the sanitized `-chdir` flag derived from `_safe_chdir_flag`.
docs/extensive-checklist.md:137:[ ] Validate all subprocess calls are properly escaped and sanitized.
docs/test-checklist.md:303:- [ ] Validate Terraform subprocess calls are sanitized and cannot escape working directories.
run_scan.sh:41:# Export an explicit VSCAN_OFFLINE override so subprocesses see the script's
scripts/automate_release.py:32:import subprocess
scripts/automate_release.py:58:def run(cmd: list[str], cwd: Path | None = None, check: bool = True) -> subprocess.CompletedProcess:
scripts/automate_release.py:60:    return subprocess.run(cmd, cwd=str(cwd) if cwd else None, check=check)
scripts/automate_release.py:109:    except subprocess.CalledProcessError as e:
scripts/automate_release.py:135:    except subprocess.CalledProcessError as e:
scripts/automate_release.py:180:        except subprocess.CalledProcessError:
scripts/automate_release.py:219:    except subprocess.CalledProcessError as e:
scripts/automate_release.py:240:    except subprocess.CalledProcessError as e:
scripts/automate_release.py:250:        out = subprocess.check_output(
scripts/automate_release.py:283:        out = subprocess.check_output(["git", "status", "--porcelain"], cwd=REPO_ROOT)
scripts/automate_release.py:292:        out = subprocess.check_output(["git", "remote", "get-url", "origin"], cwd=REPO_ROOT)
scripts/automate_release.py:307:        out = subprocess.check_output(["gpg", "--list-secret-keys", "--with-colons"], cwd=REPO_ROOT)
scripts/automate_release.py:629:        out = subprocess.check_output(cmd, cwd=REPO_ROOT)
scripts/automate_release.py:631:    except subprocess.CalledProcessError as e:
scripts/automate_release.py:679:        except subprocess.CalledProcessError:
scripts/automate_release.py:692:            except subprocess.CalledProcessError as e:
scripts/automate_release.py:699:            except subprocess.CalledProcessError as e:
scripts/automate_release.py:729:            except subprocess.CalledProcessError as e:
scripts/automate_release.py:738:            except subprocess.CalledProcessError as e:
scripts/collect_test_metrics.py:15:import subprocess
scripts/collect_test_metrics.py:27:    proc = subprocess.run(cmd, capture_output=True, text=True, check=False)
scripts/create_release_bundle.py:20:import subprocess
scripts/create_release_bundle.py:69:        out = subprocess.check_output(["git", "status", "--porcelain"], cwd=repo_path)
scripts/create_release_bundle.py:118:        subprocess.run(
scripts/generate_schema_docs.py:8:import subprocess
scripts/generate_schema_docs.py:1315:        result = subprocess.run(cmd, capture_output=True, text=True, env=env)
scripts/generate_schema_docs.py:1334:        result = subprocess.run(cmd, capture_output=True, text=True, env=env)
scripts/gumroad_upload_validator.py:13:import subprocess
scripts/gumroad_upload_validator.py:59:    result = subprocess.run(cmd, capture_output=True, text=True)
scripts/mutation_test.py:19:import subprocess
scripts/mutation_test.py:45:    proc = subprocess.run(cmd, capture_output=True, text=True, check=False)
scripts/release_artifact_verifier.py:8:import subprocess
scripts/release_artifact_verifier.py:78:    result = subprocess.run(cmd, capture_output=True, text=True)
scripts/signing_key_revocation.py:10:import subprocess
scripts/signing_key_revocation.py:93:    result = subprocess.run(cmd, capture_output=True, text=True)
scripts/signing_key_rotation.py:19:import subprocess
scripts/signing_key_rotation.py:110:    result = subprocess.run(cmd, capture_output=True, text=True)
tests/conftest.py:111:    Many CLI-focused tests spawn subprocesses without custom env overrides, so we
tests/copilot_generated/test_cli_smoke.py:12:import subprocess
tests/copilot_generated/test_cli_smoke.py:23:def _run_cli(fixture_name: str, *flags: str) -> subprocess.CompletedProcess[str]:
tests/copilot_generated/test_cli_smoke.py:32:    return subprocess.run(cmd, capture_output=True, text=True, check=False, env=env)
tests/e2e/test_cli_api_lead_e2e.py:4:import subprocess
tests/e2e/test_cli_api_lead_e2e.py:74:    result = subprocess.run(cmd, capture_output=True, text=True, env=env)
tests/e2e/test_cli_api_lead_e2e.py:122:    result = subprocess.run(cmd, capture_output=True, text=True, env=env)
tests/e2e/test_full_user_journey.py:6:import subprocess
tests/e2e/test_full_user_journey.py:39:    result = subprocess.run(cmd, capture_output=True, text=True, cwd=bundle_root, env=env)
tests/e2e/test_stress_determinism.py:3:import subprocess
tests/e2e/test_stress_determinism.py:25:    result = subprocess.run(cmd, capture_output=True, text=True, cwd=_ROOT, env=env)
tests/integration/test_bundle_integrity_checker.py:2:import subprocess
tests/integration/test_bundle_integrity_checker.py:17:    return subprocess.run(
tests/integration/test_gumroad_download_guard.py:5:import subprocess
tests/integration/test_gumroad_download_guard.py:52:    return subprocess.run(
tests/integration/test_gumroad_email_checker.py:1:import subprocess
tests/integration/test_gumroad_email_checker.py:13:    return subprocess.run(
tests/integration/test_gumroad_validator.py:3:import subprocess
tests/integration/test_gumroad_validator.py:13:    return subprocess.run(
tests/integration/test_packaging_verification.py:5:import subprocess
tests/integration/test_packaging_verification.py:219:    result = subprocess.run(
tests/integration/test_policy_cli_integration.py:3:import subprocess
tests/integration/test_policy_cli_integration.py:21:    return subprocess.run(args, capture_output=True)
tests/integration/test_release_artifact_verifier.py:4:import subprocess
tests/integration/test_release_artifact_verifier.py:16:    return subprocess.run(
tests/integration/test_signing_key_revocation.py:3:import subprocess
tests/integration/test_signing_key_revocation.py:75:    return subprocess.run(
tests/integration/test_signing_key_rotation.py:3:import subprocess
tests/integration/test_signing_key_rotation.py:75:    return subprocess.run(
tests/integration/test_terraform_cli_integration.py:2:import subprocess
tests/integration/test_terraform_cli_integration.py:12:    p = subprocess.run(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True, check=False)
tests/integration/test_terraform_gating_integration.py:3:import subprocess
tests/integration/test_terraform_gating_integration.py:63:    result = subprocess.run(cmd, capture_output=True, text=True, env=env)
tests/integration/test_verify_script.py:3:import subprocess
tests/integration/test_verify_script.py:13:    result = subprocess.run(
tests/performance/test_performance_sanity.py:3:import subprocess
tests/performance/test_performance_sanity.py:31:    p = subprocess.run(
tests/performance/test_performance_sanity.py:33:        stdout=subprocess.PIPE,
tests/performance/test_performance_sanity.py:34:        stderr=subprocess.PIPE,
tests/performance/test_streaming_slo.py:3:import subprocess
tests/performance/test_streaming_slo.py:35:) -> subprocess.CompletedProcess:
tests/performance/test_streaming_slo.py:38:    return subprocess.run(cmd, cwd=ROOT, env=env, capture_output=True, text=True, check=False)
tests/test_audit_ledger.py:4:import subprocess
tests/test_audit_ledger.py:39:    subprocess.run(
tests/test_audit_ledger.py:102:    result = subprocess.run(
tests/test_audit_ledger.py:203:    subprocess.run(
tests/test_cli.py:4:import subprocess
tests/test_cli.py:37:    return subprocess.run(cmd, capture_output=True, text=True, env=base_env)
tests/test_end_to_end_scenarios.py:4:import subprocess
tests/test_end_to_end_scenarios.py:56:    return subprocess.run(
tests/test_end_to_end_scenarios.py:121:    result = subprocess.run(
tests/test_error_handling.py:2:import subprocess
tests/test_error_handling.py:10:    res = subprocess.run(
tests/test_error_handling.py:21:    res = subprocess.run(
tests/test_error_handling.py:39:    res = subprocess.run(
tests/test_iam_drift.py:2:import subprocess
tests/test_iam_drift.py:11:    res = subprocess.run(
tests/test_json_output.py:3:import subprocess
tests/test_json_output.py:75:    return subprocess.run(
tests/test_json_output.py:104:    return subprocess.run(
tests/test_tfplan_structure.py:3:import subprocess
tests/test_tfplan_structure.py:16:    return subprocess.run(
tests/unit/test_cli_fuzz_unit.py:7:import subprocess
tests/unit/test_cli_fuzz_unit.py:61:    proc = subprocess.run(
tests/unit/test_cli_fuzz_unit.py:63:        stdout=subprocess.PIPE,
tests/unit/test_cli_fuzz_unit.py:64:        stderr=subprocess.PIPE,
tests/unit/test_lead_capture.py:4:import subprocess
tests/unit/test_lead_capture.py:285:    result = subprocess.run(
tests/unit/test_lead_capture.py:299:    result = subprocess.run(
tests/unit/test_lead_capture.py:449:    result = subprocess.run(
tests/unit/test_lead_capture.py:462:    result = subprocess.run(
tests/unit/test_lead_capture.py:499:    result = subprocess.run(
tests/unit/test_lead_capture_unit.py:4:import subprocess
tests/unit/test_lead_capture_unit.py:45:def run_vectorscan_cli(args) -> subprocess.CompletedProcess[bytes]:
tests/unit/test_lead_capture_unit.py:49:    return subprocess.run([sys.executable, str(CLI_PATH), *args], capture_output=True, env=env)
tests/unit/test_subprocess_sanitization.py:92:    monkeypatch.setattr(vscan.subprocess, "run", fake_run)
tests/unit/test_terraform_chaos_unit.py:71:    monkeypatch.setattr(vs.subprocess, "run", fake_run)
tests/unit/test_vectorscan.py:142:import subprocess
tests/unit/test_vectorscan.py:161:    p = subprocess.run(
tests/unit/test_vectorscan.py:163:        stdout=subprocess.PIPE,
tests/unit/test_vectorscan.py:164:        stderr=subprocess.PIPE,
tools/vectorscan/copilot_determinism_guard.py:8:import subprocess
tools/vectorscan/copilot_determinism_guard.py:34:    result = subprocess.run(cmd, capture_output=True, text=True, check=False, env=env)
tools/vectorscan/copilot_suite_generator.py:38:import subprocess
tools/vectorscan/copilot_suite_generator.py:49:def _run_cli(fixture_name: str, *flags: str) -> subprocess.CompletedProcess[str]:
tools/vectorscan/copilot_suite_generator.py:58:    return subprocess.run(cmd, capture_output=True, text=True, check=False, env=env)
tools/vectorscan/entrypoint_shim.py:5:import subprocess as _subprocess_module
tools/vectorscan/entrypoint_shim.py:61:subprocess = _subprocess_module
tools/vectorscan/entrypoint_shim.py:200:	legacy.subprocess = subprocess
tools/vectorscan/terraform.py:11:import subprocess
tools/vectorscan/terraform.py:265:            result = subprocess.run(
tools/vectorscan/terraform.py:279:            result = subprocess.run([str(binary), "version"], capture_output=True, text=True)
tools/vectorscan/terraform.py:407:        init_result = subprocess.run(cmd_init, capture_output=True, text=True)
tools/vectorscan/terraform.py:425:        test_result = subprocess.run(cmd_test, capture_output=True, text=True)
tools/vectorscan/vectorscan.py:15:import subprocess as _subprocess_module
tools/vectorscan/vectorscan.py:225:subprocess = _subprocess_module
tools/vectorscan/vectorscan.py:279:    "subprocess",
tree.txt:242:tests/unit/test_subprocess_sanitization.py
